# 多线程编程
## Linux线程描述
- 线程是程序中完成一个独立任务的完整执行序列，即一个可调度的实体。线程可以分为内核线程与用户线程，内核线程运行在内核空间，由内核来调度；用户线程运行在用户空间，由线程库来调度。**内核线程相当于用户线程的容器**，当进程的一个内核线程获得CPU使用权时，它就加载并运行一个用户线程。
- 一个进程可以拥有M个用户线程和N个内核线程，一般M大于等于N，不可能装用户线程的容器比用户线程还多。线程的实现方式有3种，完全由内核调度，完全在用户空间中实现和内核和用户空间双层调度。
- 完全由内核调度的线程就是基本的线程，一般M:N=1:1。这种线程切换时要通过内核来实现，由于线程调度时，需要从用户态切换到内核态，所以其线程切换的速度一般。
- 完全在用户空间中实现的线程又叫做协程，此时内核并不知道你是否有协程创建，创建了多少，对外它只认为你创建了一个线程;协程的优点是线程创建与调度完全不用内核去干预，所以切换速度很快，而且协程不占据额外内核资源，所以创建所需资源少。但是协程问题在于对于内核而言他认为你的程序只有一个线程，所以对于多cpu的系统，没有办法将多个协程运行在多个CPU上。因为内核的最小调度单位是一个线程。
- 双层调度模式是，每个cpu上运行一个内核线程，一个内核线程包括着多个协程，这种方法不会消耗过多内核资源，切换速度较快，而且它可以充分利用多处理器的优势。